<!DOCTYPE html>
<html>
<head>
<title>Character Pane</title>

<style>
body {
  background: #0f0f14;
  color: #ddd;
  font-family: Arial;
}

.pane {
  width: 700px;
  border: 3px solid #444;
  background: #1a1a22;
  padding: 20px;
  position: relative;
  overflow: visible;
}

.title {
  text-align: center;
  color: gold;
  font-size: 32px;
  margin-bottom: 15px;
}

.portrait {
  width: 180px;
  height: 180px;
  border: 4px solid gold;
  margin: 0 auto 15px auto;
  background-size: cover;
  background-position: center;
}

.equipment {
  display: grid;
  grid-template-columns: 120px 160px 120px;
  grid-template-rows: repeat(4, 120px);
  gap: 15px;
  justify-content: center;
  align-items: center;
}

.slot {
  width: 100px;
  height: 100px;
  border: 2px solid #777;
  background: #222;
  position: relative;
  cursor: pointer;
  overflow: visible;
}

.slot img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  pointer-events: none;
}

.slot:hover {
  border-color: gold;
}

.tooltip {
  position: absolute;
  background: black;
  color: white;
  border: 1px solid gold;
  padding: 8px;
  font-size: 16px;
  width: 220px;
  display: none;
  z-index: 999;
  left: 110px;
  top: 0;
  pointer-events: none;
}

.slot:hover .tooltip {
  display: block;
}
</style>
</head>

<body>

<div class="pane">

  <div class="title" id="name">Loading...</div>
  <div class="portrait" id="portrait"></div>

  <div class="equipment">
    <div class="slot" id="Head"><img><div class="tooltip"></div></div>
    <div class="slot" id="Gloves"><img><div class="tooltip"></div></div>

    <div></div>

    <div class="slot" id="Weapon"><img><div class="tooltip"></div></div>
    <div class="slot" id="Chest"><img><div class="tooltip"></div></div>
  </div>

</div>

<script>
const charURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSuibkGWLHa5Sz7rJtRjgpZUnG6ZNxgtuxfFqiJB_OsUVqmOaxthADcFLJwmWxfAYvPO2zjFLroosZ1/pub?gid=0&single=true&output=csv";
const gearURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSuibkGWLHa5Sz7rJtRjgpZUnG6ZNxgtuxfFqiJB_OsUVqmOaxthADcFLJwmWxfAYvPO2zjFLroosZ1/pub?gid=457348905&single=true&output=csv";

function parseCSV(text) {
  return text.trim().split("\n").map(r => r.split(","));
}

fetch(charURL)
.then(r => r.text())
.then(t => {
  const data = {};
  parseCSV(t).forEach(row => data[row[0]] = row[1]);

  document.getElementById("name").innerText = data["Name"];
  document.getElementById("portrait").style.backgroundImage =
    `url(${data["Portrait"]})`;
});

fetch(gearURL)
.then(r => r.text())
.then(t => {
  const rows = parseCSV(t);

  rows.slice(1).forEach(row => {
    const [slot, item, desc, icon] = row;
    const el = document.getElementById(slot);
    if (!el) return;

    el.querySelector("img").src = icon;

    const tip = el.querySelector(".tooltip");
    tip.innerHTML = `<b>${item}</b><br>${desc}`;
  });
});
</script>

</body>
</html>
